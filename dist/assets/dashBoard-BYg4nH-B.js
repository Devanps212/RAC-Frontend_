import{r as e,aE as _,B as y,j as s,bf as R,bg as $,bh as L,bi as Q,bj as q,bk as H,bl as J,bm as K,Q as V,b1 as X}from"./index-Cl2SN7aR.js";const Y=()=>{const[C,p]=e.useState({labels:[],datasets:[]}),[Z,k]=e.useState({labels:[],datasets:[]}),[B,D]=e.useState([]),[S,w]=e.useState([]),[A,T]=e.useState(0),[E,M]=e.useState(0),[F,O]=e.useState(0),[I,P]=e.useState(0);return e.useRef(null),e.useEffect(()=>{const r=async()=>{const a=await J();if(Array.isArray(a)){const n=a.length;T(n)}},d=async()=>{const a=await K();O(a.length)},z=async()=>{try{const n=(await V("all")).data;console.log("bokings found :",n);const o={},l={},c={};let u=0,b=0;const j=[],f=[];Array.isArray(n)&&n.forEach((t,U)=>{var g,N,v;const m=t.status;o[m]?o[m]++:o[m]=1;const h=((g=t.transaction)==null?void 0:g.amount)??0,i=(N=t.transaction)==null?void 0:N.transactionId;i&&(l[i]?l[i]+=h:l[i]=h);const x=new Date(t.date.start).toISOString().split("T")[0];c[x]?c[x]++:c[x]=1;const G=new Date(t.date.start).getMonth(),W=new Date().getMonth();G===W&&(u++,b+=h),j.push({id:t._id,start:new Date(t.date.start).getTime(),end:new Date(t.date.end).getTime(),name:`Booking ${t._id}`,y:U}),f.push(((v=t.carId)==null?void 0:v.name)??`Booking ${t._id}`)}),M(u),P(b),p({labels:Object.keys(o),datasets:[{label:"Number of Bookings by Status",data:Object.values(o),backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderWidth:1},{label:"Total Booking Amounts",data:Object.values(l),backgroundColor:"rgba(255,99,132,0.4)",borderColor:"rgba(255,99,132,1)",borderWidth:1}]}),k({labels:Object.keys(c),datasets:[{label:"Number of Bookings by Date",data:Object.values(c),backgroundColor:"rgba(153,102,255,0.4)",borderColor:"rgba(153,102,255,1)",borderWidth:1}]}),D(j),w(f)}catch(a){y.error(a.message)}};r(),d(),z()},[]),e.useEffect(()=>{const r=_("https://easyrentacar.shop");return r.on("newBooking",({message:d})=>{y.info(d)}),()=>{r.disconnect()}},[]),s.jsx("div",{className:"container-fluid",children:s.jsxs("div",{className:"row",children:[s.jsx("h3",{children:"Dashboard"}),s.jsxs("div",{className:"contents d-flex flex-column justify-content-center align-items-center",children:[s.jsx("div",{className:"col-md-6",style:{width:"inherit"},children:s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-12 col-md-3 mb-3",children:s.jsx("div",{className:"box-contents box-contents-blue",children:s.jsxs("div",{className:"box-one d-flex flex-column justify-content-center align-items-center",children:[s.jsx(R,{className:"mt-2",style:{fontSize:"50px"}}),s.jsx("strong",{className:"mt-2",children:"Total Customers"}),s.jsxs("h5",{className:"mt-2",children:[A," Nos"]})]})})}),s.jsx("div",{className:"col-12 col-md-3 mb-3",children:s.jsx("div",{className:"box-contents box-contents-yellow",children:s.jsxs("div",{className:"box-one d-flex flex-column justify-content-center align-items-center",children:[s.jsx($,{className:"mt-2",style:{fontSize:"50px"}}),s.jsx("strong",{className:"mt-2",children:"Bookings (This Month)"}),s.jsxs("h5",{className:"mt-2",children:[E," Nos"]})]})})}),s.jsx("div",{className:"col-12 col-md-3 mb-3",children:s.jsx("div",{className:"box-contents box-contents-red",children:s.jsxs("div",{className:"box-one d-flex flex-column justify-content-center align-items-center",children:[s.jsx(L,{className:"mt-2",style:{fontSize:"50px"}}),s.jsx("strong",{className:"mt-2",children:"Earnings (This Month)"}),s.jsxs("h5",{className:"mt-2",children:["â‚¹ ",I]})]})})}),s.jsx("div",{className:"col-12 col-md-3 mb-3",children:s.jsx("div",{className:"box-contents box-contents-green",children:s.jsxs("div",{className:"box-one d-flex flex-column justify-content-center align-items-center",children:[s.jsx(Q,{className:"mt-2",style:{fontSize:"50px"}}),s.jsx("strong",{className:"mt-2",children:"Total Partners"}),s.jsxs("h5",{className:"mt-2",children:[F," Nos"]})]})})})]})}),s.jsx("div",{className:"col-12 mt-4",children:s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-12 col-xl-6 chart-container",children:s.jsx("div",{className:"chart",children:s.jsx(q,{data:C})})}),s.jsx("div",{className:"col-12 col-xl-6 chart-container",children:s.jsx("div",{className:"chart",children:s.jsx(H,{tasks:B,categories:S})})})]})})]})]})})},ts=()=>s.jsx(s.Fragment,{children:s.jsx(X,{children:s.jsx(Y,{})})});export{ts as default};
